package gjson

import (
	"fmt"
	"github.com/qxyang2015/jsonslice"
	"strings"
)

const json = `{"DOCUMENT":{"PRH":{"PA01":{"PA01A":{"PA01AI01":"2019051111255756829216","PA01AR01":"2019-05-11 11:25:57"},"PA01B":{"PA01BQ01":"陈荣*","PA01BD01":"身份证","PA01BI01":"35058219940929XXXX","PA01BI02":"30510000100800","PA01BD02":"贷后管理"},"PA01C":null,"PA01D":null,"PA01E":{"PA01ES01":0}}},"PIM":{"PB01":{"PB01A":{"PB01AD01":"男","PB01AR01":"1994.09.29","PB01AD02":"中专、职高、技校","PB01AD03":null,"PB01AD04":"在职","PB01AQ01":null,"PB01AQ02":"陈埭镇大乡村大南路32号","PB01AD05":"中国","PB01AQ03":"福建省泉州市晋江市陈埭镇大乡村大南路32号"},"PB01B":{"PB01BS01":1,"PB01BH":[{"PB01BQ01":"18559589520","PB01BR01":"2016.10.22"}]}}},"PMM":{"PB02":{"PB020D01":"未婚","PB020Q01":null,"PB020D02":null,"PB020I01":null,"PB020Q02":null,"PB020Q03":null}},"PRM":{"PB03":[{"PB030D01":"自置","PB030Q01":"福建省泉州市晋江市西滨镇海滨路125号","PB030Q02":"0000-000000","PB030R01":"2016.10.22"},{"PB030D01":"自置","PB030Q01":"福建省泉州市晋江市陈埭镇大乡村大南路32号","PB030Q02":null,"PB030R01":"2016.04.28"}]},"POM":{"PB04":[{"PB040D01":"91","PB040Q01":"晋江华天塑胶有限公司","PB040D02":null,"PB040D03":"制造业","PB040Q02":null,"PB040Q03":"0595-85128677","PB040D04":"专业技术人员","PB040D05":"一般员工","PB040D06":null,"PB040R01":null,"PB040R02":"2016.10.22"},{"PB040D01":"91","PB040Q01":"鑫能鞋材加工厂","PB040D02":null,"PB040D03":"制造业","PB040Q02":"福建省泉州市晋江市西滨镇海滨街125号","PB040Q03":null,"PB040D04":"商业、服务业人员","PB040D05":"一般员工","PB040D06":null,"PB040R01":null,"PB040R02":"2016.04.28"}]},"PSM":null,"PCO":{"PC02":{"PC02A":{"PC02AS01":3,"PC02AS02":6,"PC02AH":[{"PC02AD01":"个人住房贷款","PC02AD02":"贷款","PC02AS03":null,"PC02AR01":null},{"PC02AD01":"个人商用房贷款（包括商住两用房）","PC02AD02":"贷款","PC02AS03":null,"PC02AR01":null},{"PC02AD01":"其他类贷款","PC02AD02":"贷款","PC02AS03":2,"PC02AR01":"2016.04.01"},{"PC02AD01":"贷记卡","PC02AD02":"信用卡","PC02AS03":1,"PC02AR01":"2016.10.01"},{"PC02AD01":"准贷记卡","PC02AD02":"信用卡","PC02AS03":null,"PC02AR01":null},{"PC02AD01":null,"PC02AD02":"其他","PC02AS03":null,"PC02AR01":null}]},"PC02B":null,"PC02C":null,"PC02D":{"PC02DS01":5,"PC02DH":[{"PC02DD01":"非循环贷账户","PC02DS02":2,"PC02DS03":6,"PC02DJ01":539,"PC02DS04":2},{"PC02DD01":"循环额度下分账户","PC02DS02":null,"PC02DS03":null,"PC02DJ01":null,"PC02DS04":null},{"PC02DD01":"循环贷账户","PC02DS02":null,"PC02DS03":null,"PC02DJ01":null,"PC02DS04":null},{"PC02DD01":"贷记卡账户","PC02DS02":1,"PC02DS03":1,"PC02DJ01":2500,"PC02DS04":1},{"PC02DD01":"准贷记卡账户","PC02DS02":null,"PC02DS03":null,"PC02DJ01":null,"PC02DS04":null}]},"PC02E":null,"PC02F":null,"PC02G":null,"PC02H":null,"PC02I":null,"PC02K":null}},"PNO":null,"PPO":null,"PQO":{"PC05":{"PC05A":{"PC05AR01":"2018.09.15","PC05AD01":"商业银行","PC05AI01":"XT","PC05AQ01":"信用卡审批"},"PC05B":null}},"PDA":{"PD01":[{"PD01A":{"PD01AI01":null,"PD01AD01":"非循环贷账户","PD01AD02":"商业银行","PD01AI02":"EC","PD01AI03":"******","PD01AI04":null,"PD01AD03":"其他个人消费贷款","PD01AR01":"2016.04.28","PD01AD04":"人民币元","PD01AJ01":2704,"PD01AJ02":null,"PD01AJ03":null,"PD01AR02":"2017.08.04","PD01AD05":null,"PD01AD06":"月","PD01AS01":16,"PD01AD07":"信用/免担保","PD01AD08":null,"PD01AD09":"无","PD01AD10":null},"PD01B":{"PD01BD01":"结清","PD01BR01":"2017.05.26","PD01BR04":null,"PD01BJ01":null,"PD01BR02":null,"PD01BJ02":null,"PD01BD03":null,"PD01BD04":null,"PD01BR03":"2017.07.23"},"PD01C":null,"PD01D":null,"PD01E":{"PD01ER01":"2016.04.01","PD01ER02":"2017.07.01","PD01ES01":16,"PD01EH":[{"PD01ER03":"2017.07.01","PD01ED01":"C","PD01EJ01":0},{"PD01ER03":"2017.06.01","PD01ED01":"1","PD01EJ01":196},{"PD01ER03":"2017.05.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2017.04.01","PD01ED01":"1","PD01EJ01":196},{"PD01ER03":"2017.03.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2017.02.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2017.01.01","PD01ED01":"1","PD01EJ01":196},{"PD01ER03":"2016.12.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.11.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.10.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.09.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.08.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.07.01","PD01ED01":"1","PD01EJ01":196},{"PD01ER03":"2016.06.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.05.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.04.01","PD01ED01":"*","PD01EJ01":0}]},"PD01F":null,"PD01G":null,"PD01H":null,"PD01Z":null},{"PD01A":{"PD01AI01":null,"PD01AD01":"非循环贷账户","PD01AD02":"小额贷款公司","PD01AI02":"KG","PD01AI03":"******","PD01AI04":null,"PD01AD03":"其他个人消费贷款","PD01AR01":"2016.11.07","PD01AD04":"人民币元","PD01AJ01":3500,"PD01AJ02":null,"PD01AJ03":null,"PD01AR02":"2019.11.07","PD01AD05":null,"PD01AD06":"不定期","PD01AS01":null,"PD01AD07":"组合（不含保证）","PD01AD08":null,"PD01AD09":"无","PD01AD10":null},"PD01B":{"PD01BD01":"结清","PD01BR01":"2017.04.27","PD01BR04":null,"PD01BJ01":null,"PD01BR02":null,"PD01BJ02":null,"PD01BD03":null,"PD01BD04":null,"PD01BR03":"2017.04.27"},"PD01C":null,"PD01D":null,"PD01E":{"PD01ER01":"2016.11.01","PD01ER02":"2017.04.01","PD01ES01":6,"PD01EH":[{"PD01ER03":"2017.04.01","PD01ED01":"C","PD01EJ01":0},{"PD01ER03":"2017.03.01","PD01ED01":"2","PD01EJ01":539},{"PD01ER03":"2017.02.01","PD01ED01":"1","PD01EJ01":275},{"PD01ER03":"2017.01.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.12.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.11.01","PD01ED01":"*","PD01EJ01":0}]},"PD01F":{"PD01FS01":1,"PD01FH":[{"PD01FD01":"担保人（第三方）代偿","PD01FR01":"2017.04.27","PD01FS02":0,"PD01FJ01":3263,"PD01FQ01":"3263"}]},"PD01G":null,"PD01H":null,"PD01Z":null},{"PD01A":{"PD01AI01":null,"PD01AD01":"贷记卡账户","PD01AD02":"商业银行","PD01AI02":"WO","PD01AI03":"******","PD01AI04":null,"PD01AD03":"贷记卡","PD01AR01":"2016.10.22","PD01AD04":"人民币元","PD01AJ01":null,"PD01AJ02":25000,"PD01AJ03":25000,"PD01AR02":null,"PD01AD05":null,"PD01AD06":null,"PD01AS01":null,"PD01AD07":"信用/免担保","PD01AD08":null,"PD01AD09":null,"PD01AD10":null},"PD01B":{"PD01BD01":"销户","PD01BR01":"2017.03.14","PD01BR04":null,"PD01BJ01":null,"PD01BR02":null,"PD01BJ02":null,"PD01BD03":null,"PD01BD04":null,"PD01BR03":"2017.03.14"},"PD01C":null,"PD01D":null,"PD01E":{"PD01ER01":"2016.10.01","PD01ER02":"2017.03.01","PD01ES01":6,"PD01EH":[{"PD01ER03":"2017.03.01","PD01ED01":"C","PD01EJ01":0},{"PD01ER03":"2017.02.01","PD01ED01":"1","PD01EJ01":2500},{"PD01ER03":"2017.01.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.12.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.11.01","PD01ED01":"N","PD01EJ01":0},{"PD01ER03":"2016.10.01","PD01ED01":"*","PD01EJ01":0}]},"PD01F":null,"PD01G":null,"PD01H":null,"PD01Z":null}]},"PCA":null,"PCR":null,"PND":null,"POT":null,"PCJ":null,"PCE":null,"PAP":null,"PHF":null,"PBS":null,"PPQ":null,"PAH":null,"POS":null,"POQ":{"PH01":[{"PH010R01":"2018.09.15","PH010D01":"商业银行","PH010Q02":"XT","PH010Q03":"信用卡审批"},{"PH010R01":"2018.08.30","PH010D01":"商业银行","PH010Q02":"AB","PH010Q03":"贷款审批"},{"PH010R01":"2018.08.18","PH010D01":"商业银行","PH010Q02":"XS","PH010Q03":"信用卡审批"},{"PH010R01":"2018.08.16","PH010D01":"商业银行","PH010Q02":"CD","PH010Q03":"信用卡审批"},{"PH010R01":"2017.12.20","PH010D01":"商业银行","PH010Q02":"CV","PH010Q03":"信用卡审批"}]}}}`

func GojsonDemo() {
	//jsonPath := `DOCUMENT.PDA.PD01.#(PD01A.PD01AR01>="2016.04.28")#.PD01A`
	//jsonPath:=`DOCUMENT.PDA.PD01.#(PD01A.PD01AR01>="2016.04.28")#|#(PD01A.PD01AD03%"*贷款")#.PD01A`
	//jsonPath := `DOCUMENT.PDA.PD01.#(PD01A.PD01AR01>="2016.04.28")#`
	jsonPath := `$.DOCUMENT.PDA.PD01[?(@.PD01A.PD01AR01 |! "2016.11.07,2016.04.28")].PD01A`
	str, err := GetString(jsonPath)
	fmt.Println(str, err)
}

func GetString(jsonpath string) (string, error) {
	get, err := jsonslice.Get([]byte(json), jsonpath)
	if err != nil {
		return "", err
	}
	s := string(get)
	if strings.HasSuffix(s, "\"") && strings.HasPrefix(s, "\"") {
		s = s[1 : len(s)-1]
	}
	return s, nil
}
